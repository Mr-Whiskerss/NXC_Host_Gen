# generate_hosts

A [NetExec](https://github.com/Pennyw0rth/NetExec) module that automatically generates a hosts file from SMB scan results, mapping IP addresses to hostnames discovered during authentication.

## Features

- Captures IP-to-hostname mappings during SMB scans
- Outputs in standard `/etc/hosts` format
- Writes incrementally (no data loss if scan is interrupted)
- Optional FQDN support with domain suffix
- Append mode for combining results across multiple scans
- Sorted output by IP address for readability

## Installation

```bash
cp generate_hosts.py ~/.nxc/modules/
```

## Usage

```bash
# Basic usage
nxc smb 192.168.1.0/24 -u user -p pass -M generate_hosts

# Custom output file
nxc smb 10.0.0.0/24 -u user -p pass -M generate_hosts -o OUTPUT=/tmp/hosts.txt

# Include FQDN entries
nxc smb 192.168.1.0/24 -u user -p pass -M generate_hosts -o DOMAIN=true

# Append to existing file
nxc smb 10.10.10.0/24 -u user -p pass -M generate_hosts -o APPEND=true
```

## Options

| Option | Default | Description |
|--------|---------|-------------|
| OUTPUT | `./hosts_nxc.txt` | Path to output hosts file |
| APPEND | `False` | Append to existing file instead of overwriting |
| DOMAIN | `False` | Include domain suffix in hostnames (FQDN) |

## Example Output

```
# Generated by nxc generate_hosts module
# Date: 2025-01-15 14:32:18
# Total hosts: 5
#==================================================

192.168.1.10	dc01.corp.local dc01
192.168.1.20	fileserver
192.168.1.25	workstation01
192.168.1.30	webapp01
192.168.1.50	sqlserver
```

## Use Cases

- Quickly build a hosts file for a new engagement
- Populate `/etc/hosts` for easier navigation during assessments
- Create hostname references for reporting
- Combine with other tools that rely on hostname resolution

## License

MIT
